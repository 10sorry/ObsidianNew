---
image: "[[70_Attachments/ign_waifu_upscayl_4x_upscayl-standard-4x.png]]"
---
# База по команде поиска `awk`

`awk` читает текст построчно, и для каждой строки выполняет правила вида:

```bash
pattern { action }
```

`pattern` — условие (например, совпадение с _regex_).

`action` — что делать, если совпало (print, присвоение переменных, массивы и т.д.).

## Поля в awk

awk автоматически делит каждую строку на поля по пробелам и табуляциям (по умолчанию).

- - $0 — вся строка целиком

- - $1 — первое поле

- - $2 — второе поле

- - $3 — третье поле

- - $n — n-е поле

- - NF — количество полей в строке

## Поля и сепараторы `(FS)` или `-F`

По умолчанию awk делит строку на поля по пробелу или табуляции.

`$1`, `$2`, ... → первое, второе поле

`$0` → вся строка

Изменение сепаратора

```bash
awk 'BEGIN { FS="," } { print $1, $3 }' file.csv
```


`FS (Field Separator)` → разделитель полей

В этом примере строки разделены запятыми, и мы выводим 1-е и 3-е поле.

Можно задать и через командную строку:

```bash
awk -F":" '{print $1, $2}' /etc/passwd
```

`-F":"` → поля разделены двоеточием

## `NF` — количество полей

`NF → Number of Fields`

Автоматически показывает, сколько полей в текущей строке

Можно использовать для проверки:

```bash
awk 'NF > 3 {print $0}' file
```

Выведет строки, где больше 3 полей

`$NF` → последнее поле

```bash
awk '{print $1, $NF}' file
```

## Переменные в awk

В awk можно создавать свои переменные, присваивать значения, использовать для счётчиков, сумм, флагов:

```bash
awk '{ sum += $4 } END { print "Total:", sum }' file
```

`sum` — переменная, суммирует 4-е поле всех строк

`END { ... }` — выполняется после обработки всех строк

Примеры полезных переменных:

`NR` → номер текущей строки (Number of Record)

`FNR` → номер строки в текущем файле

`NF` → количество полей в текущей строке

`$0` → вся строка

`$1`, `$2`, ... → поля

## Смена разделителей вывода

`OFS (Output Field Separator)` — разделитель между полями при print `$1`, `$2`

```bash
awk 'BEGIN { OFS="|" } { print $1, $2, $3 }' file
```

Вывод будет: `ajay|manager|account`

- Выведет первое и последнее поле каждой строки

Самый простой пример:

```bash
awk '{print}' example.nvim
```
- Просто находит весь файл

Еще пример:

```bash
awk '/000/ {print}' example.nvim
```
## Точное совпадение

```bash
awk '/\b000\b/ {print}' example.nvim
```
![[ign_waifu_upscayl_4x_upscayl-standard-4x.png]]