[[c++]] #cpp
## Что такое агрегатная инициализация?

**Агрегат** — это тип, который соответствует ряду условий:

- Нет пользовательских (неявных) конструкторов,
    
- Нет приватных или защищённых (protected) членов,
    
- Нет виртуальных функций,
    
- Нет базовых классов,
    
- Все члены — публичные (public) или struct по умолчанию public.
    

В C++17 и более новых стандартах правила чуть шире, чем были раньше (C++11), но смысл тот же.

Для таких типов можно делать инициализацию через списки в фигурных скобках `{}`, перечисляя значения членов в порядке их объявления.

---

## Пример

```
struct Point {
    int x;
    int y;
};

Point p1 = {10, 20};  // агрегатная инициализация
```

Здесь мы просто говорим компилятору: `x = 10`, `y = 20`.

---

## Немного сложнее: вложенные структуры

```
struct Rect {
    Point topLeft;
    Point bottomRight;
};

Rect r = { {0, 0}, {100, 100} };
```

Тут инициализация — вложенный список: сначала инициализируем `topLeft`, потом `bottomRight`.

---

## Особенности и подводные камни

1. **Порядок инициализации важен!**  
    Значения в `{}` соответствуют членам по порядку объявления.
    
2. **Если указать меньше элементов, чем членов — остальные инициализируются значениями по умолчанию (для встроенных типов — нулями).**
    

```
Point p2 = {5};  // x = 5, y = 0 (value-initialized)
```

3. **Нельзя агрегатную инициализацию использовать, если есть пользовательские конструкторы или private-члены.**
    

---

## Почему агрегатная инициализация важна?

- Позволяет быстро и понятно инициализировать данные,
    
- Хорошо сочетается с `constexpr` и `std::array`,
    
- Не требует написания конструкторов, что упрощает код,
    
- В новых стандартах (C++20) стала ещё гибче, например, допускается инициализация `const` и `reference` членов.
    

---

## Краткий пример с C++20 и `const` членами

```
struct Foo {
    const int a;
    int b;
};

Foo f = {1, 2};  // Работает с C++20, агрегат с const-членом
```

---

## Как лучше использовать?

- Для POD-структур и простых «data-only» типов — агрегатная инициализация — лучший вариант.
    
- Для более сложных классов — лучше делать конструкторы, где можно контролировать логику.